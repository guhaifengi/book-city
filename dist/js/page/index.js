define(["jquery","template","swiper","text!../../tql/lunbo.html","text!../../tql/weekhot.html","text!../../tql/weight.html","text!../../tql/girl.html","text!../../tql/boy.html","text!../../tql/time.html","text!../../tql/jxzt.html","bscroll","text!../../tql/list.html"],function(s,c,r,d,h,m,b,t,u,p,g,k){s.getJSON("/book/index",function(t){console.log(t),c(d,t.items[0].data,".index-banner"),new r(".index-banner",{loop:!0,autoplay:1e3});var e=new r(".main",{onSlideChangeStart:function(t){s("header>span").eq(t.activeIndex).addClass("active").siblings().removeClass("active")}});s("header>span").on("click",function(){var t=s(this).index()-1;s(this).addClass("active").siblings().removeClass("active"),e.slideTo(t)});var i=t.items[2].data.data.splice(0,5),l=t.items[3].data.data.splice(0,5),a=t.items[4].data.data.splice(0,5);c(h,t.items[1],".weekhot"),c(m,i,".weight"),c(b,l,".girl"),c(b,a,".boy"),c(u,t.items[5],".time"),c(p,t.items[6],".jxzt"),c(k,l,".book-list");var o=1,n=new g(".book-city",{probeType:2,click:!0,click:!0});new g(".book-jia",{probeType:2,click:!0,click:!0}),n.on("scroll",function(){if(3<o)return s(".cont").attr("data-up","暂无更多数据..."),!1;this.y<this.maxScrollY-80?s(".cont").attr("data-up","释放加载更多..."):this.y<this.maxScrollY-10&&s(".cont").attr("data-up","上拉加载更多...")}),n.on("scrollEnd",function(){s(".cont").attr("data-up","上拉加载更多...")}),n.on("touchEnd",function(){if(3<o)return s(".cont").attr("data-up","暂无更多数据..."),!1;"释放加载更多..."===s(".cont").attr("data-up")&&(s.getJSON("/book/list",{page:o,limit:10},function(t){c(k,t.items,".list"),n.refresh()}),o++)}),s("#btn").on("click",function(){s(this).toggleClass("shelf__switch"),s(this).toggleClass("shelf__switch_list"),s("#book-cont").toggleClass("book-list"),s("#book-cont").toggleClass("book-table")})})});